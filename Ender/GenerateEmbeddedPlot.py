import matplotlib.pyplot as plt
import numpy as np
import os

# Medical Cost
train_mae = [8714.12581319533, 8662.41781270575, 7769.0310170066095, 7136.283800379637, 6273.071313612465, 5151.389781513854, 5043.622201503712, 4838.739948218714, 4583.86346738524, 4395.558641830545, 4355.303919186522, 4266.469269522761, 4244.773634350754, 4162.198746836583, 4132.037198514659, 4106.489770080646, 4041.726760741978, 4018.155592981331, 4007.8351254241225, 3885.982029900806, 3880.5483829370623, 3872.394791296635, 3870.0455480635965, 3862.603337933858, 3815.437252460477, 3759.7419368221226, 3759.3169367866394, 3737.8973104006027, 3697.0823425333847, 3647.825741455792, 3607.5800338664676, 3547.9672757110848, 3530.888252707129, 3467.913292568329, 3439.5217401727077, 3418.819304873481, 3391.836012790807, 3390.6508122369123, 3345.551191573383, 3260.084501497641, 3225.280342041554, 3210.6513147958494, 3195.8181100572965, 3194.115613930584, 3171.8289007413086, 3160.2995778370305, 3138.151217407253, 3129.024141493772, 3123.4337213069066, 3119.706418171656, 3110.768472997607, 3093.291241213411, 3084.9032265845735, 3075.747226371288, 3066.6279430650357, 3050.756409296022, 3050.46992904494, 3045.4548076415613, 3036.9300493836263, 3035.072788317323, 2992.7418689739034, 2978.09459747651, 2975.11693511414, 2970.9759995955574, 2965.7224010452965, 2958.022689610575, 2956.0039905546164, 2953.169204991217, 2935.9187665546133, 2919.3242634020953, 2918.849686852531, 2916.529728080631, 2910.787891954431, 2907.321274011563, 2900.731479846554, 2898.3184178614856, 2891.1000354516973, 2889.1283965917446, 2882.3876047046288, 2868.0172632183176, 2866.5828240823776, 2847.4452612085097, 2829.078434368923, 2824.5723627697553, 2822.8056457339153, 2815.576332115731, 2803.817898760044, 2803.505907957966, 2801.3661029394834, 2788.5164006423865, 2782.172004473894, 2779.9610457133294, 2779.9610457133294, 2776.9017222398506, 2775.822106695682, 2775.6888656952588, 2774.0191480660233, 2773.4568267491186, 2772.731413615211, 2772.6993208950144, 2772.5674945897645]
test_mae = [8995.187950149253, 8685.001877763296, 7662.846393367276, 6969.598151585069, 6084.030952929772, 5137.914510075807, 5034.594857247205, 4843.801800499387, 4606.7273218853525, 4433.089268561395, 4388.754303774604, 4294.642125084568, 4272.126041852671, 4185.287245599364, 4153.310221057069, 4130.373357972833, 4074.4296180824613, 4055.128847353284, 4047.0344631099088, 3955.4439827595406, 3951.1399337298053, 3944.8566002245834, 3942.9202689127605, 3936.9645767998554, 3898.6572417722145, 3850.506970542555, 3850.121351904356, 3830.6680731326014, 3791.535650939106, 3745.8199047588323, 3710.9960762369265, 3654.6659381114514, 3638.6103941829606, 3578.0946341435483, 3552.7002864045335, 3534.5854111056888, 3511.0731298212777, 3510.0322994035723, 3473.587352088034, 3403.324433610176, 3377.9975756627146, 3365.7095119713495, 3352.3700374148357, 3350.8468551330025, 3331.5619602576016, 3322.624178962398, 3306.5317779914403, 3300.058900807465, 3296.6839365875067, 3294.5693353445295, 3289.705088466443, 3279.539654184525, 3274.624241102204, 3269.178481568786, 3263.3919049101405, 3253.5390844152716, 3253.3703033817073, 3250.4917409967074, 3245.334586832263, 3244.1742590488457, 3225.2460572650243, 3220.9469041433376, 3220.293266324403, 3219.4334707386624, 3218.370945022836, 3216.954118138151, 3216.538568307783, 3216.110014871767, 3212.837270634919, 3210.2951389136624, 3210.2254181078033, 3209.9460187368977, 3209.203490470374, 3208.6232225422873, 3208.010244873087, 3207.8741705919765, 3207.264519607671, 3207.492240953954, 3209.6739205413533, 3220.242130169542, 3221.3764640695144, 3239.9908790614236, 3262.3409962447904, 3265.420441865849, 3266.221333075089, 3269.5894016655084, 3279.3471634842563, 3279.6066921406036, 3281.372517857397, 3298.094083202129, 3308.7746250042546, 3314.0917870815956, 3314.0917870815956, 3321.4911041771593, 3325.060899771769, 3325.5008762947673, 3331.2189219911734, 3333.548403723469, 3336.1612247156063, 3336.2630307637273, 3336.5143489540224]
train_mae_hist = [9038.345299159613, 6492.882065652977, 3865.4157798064766, 3460.561671982057, 3475.706098494986, 3161.8783726957054, 3077.537211313096, 3019.6982330847895, 2982.9868784484506, 2915.299859614263, 2895.6532207271825, 2810.788938122232, 2756.119971585138, 2721.600391172222, 2636.7450727765813, 2623.195779604984, 2610.0124152405206, 2556.7818056601755, 2538.417393356914, 2549.869545533911, 2558.2459274438243, 2548.6078454559843, 2510.2071720307677, 2520.9561481609976, 2513.7651490759886, 2515.383373555962, 2500.4075478261298, 2493.8917974100623, 2521.969692539831, 2481.6063417967107, 2472.850169450707, 2468.2437339979742, 2449.1057976270677, 2446.076987624925, 2433.894216918717, 2430.8749431213914, 2418.7779723680646, 2380.836005295986, 2385.732517082565, 2375.554858791101, 2376.7319335341394, 2359.2065572438655, 2364.474113303609, 2345.172545405419, 2316.5795062812235, 2297.847204257362, 2308.0757787810544, 2293.53063475469, 2274.0626388953197, 2256.0945231700734, 2252.053307243137, 2239.0985158527906, 2234.8600354482587, 2213.6058918637686, 2214.8800099127525, 2197.389305074169, 2164.384826679121, 2133.6972468017716, 2131.631199674655, 2121.3109695228227, 2120.4239698151578, 2109.8804417618585, 2098.5708242442975, 2104.874496374416, 2108.4763725170164, 2101.178508256375, 2101.714278738976, 2090.140940685706, 2090.4207866485526, 2097.4468761879457, 2077.2445162012127, 2080.7631592947805, 2058.6264557700106, 2052.725724033482, 2051.8685844540864, 2053.775731528621, 2057.424818879324, 2051.8786108536087, 2062.4263801580946, 2043.0331823720876, 2043.4104980391921, 2050.809592189881, 2043.7307273125973, 2031.4764416423934, 2009.67108578186, 2006.9897281226629, 2006.9607184963536, 2010.7718803353387, 1994.400443117449, 1992.9019895672834, 1991.9080130704504, 1986.0269830666996, 1990.7525906960575, 1963.9509443273728, 1965.6073124047753, 1971.505522772365, 1955.6483664230275, 1956.7703139166654, 1949.3895741771976, 1953.8123851029975, 1938.0894773943676]
test_mae_hist = [9197.532234648967, 6634.176551192746, 4209.615758432472, 3837.9719178289183, 3803.7727550916834, 3549.858597141668, 3498.9876739526967, 3429.82001003098, 3454.4817805283806, 3404.137524808677, 3429.667817922383, 3364.346161958432, 3337.409948556255, 3292.7980098351677, 3203.1129021477736, 3259.452895914973, 3227.064146057009, 3178.0942032151966, 3187.592590876685, 3209.172177120773, 3254.716395276009, 3272.029523786808, 3248.728426467232, 3269.2778464136895, 3269.2778464136895, 3357.042382643431, 3333.2015155895456, 3344.94939917153, 3360.99737750024, 3361.908245879363, 3348.4571950346217, 3352.6382399677454, 3350.3350120568443, 3346.262386418557, 3361.708227937464, 3442.6514424680695, 3423.0885987624583, 3395.811389144612, 3427.588870641459, 3407.660008334024, 3427.482281887041, 3433.4446871575637, 3486.0306886767444, 3486.826636605891, 3472.617123265723, 3462.750251329517, 3479.6130440259144, 3463.3794951444984, 3487.2412582464417, 3458.983612631852, 3471.7436490843193, 3467.34246085965, 3501.0800715343917, 3501.0800715343917, 3511.7914922326227, 3541.540620545367, 3506.920522905035, 3487.505974397406, 3499.5102431582063, 3520.3687690508114, 3625.82704238435, 3585.9407802158307, 3589.7899761134977, 3589.7899761134977, 3617.177299693252, 3607.778645284937, 3616.749649547783, 3629.6406368904127, 3638.6397572271467, 3695.9731156210573, 3704.0070208048623, 3705.679689588684, 3734.992828987633, 3746.9754449312445, 3746.9754449312445, 3769.123696256245, 3790.5102942300246, 3753.15191606744, 3796.9851786682984, 3793.9220372734117, 3799.4833383370624, 3812.745607083482, 3818.410648833909, 3818.410648833909, 3811.162980452635, 3811.162980452635, 3811.162980452635, 3811.162980452635, 3787.251661073004, 3812.4471868832543, 3820.5564573522465, 3824.5098201909655, 3838.1833267605334, 3848.775930609138, 3829.7655952856476, 3841.465269011777, 3823.0031084370057, 3854.778249812039, 3834.1473569766254, 3834.1473569766254, 3805.4843464297164]

# Liver Disorders
# train_mae = [2.6872727272727275, 2.6353233123421, 2.643216783216783, 2.6206545454545456, 2.392187365177196, 2.2644106958439165, 2.174540606326134, 2.1655920706605523, 2.1539994418887822, 2.146085577197794, 2.1234209294809503, 2.078277443712246, 2.064091590291518, 1.9843053726534303, 1.9802911641118361, 1.9688765853223131, 1.946406447541396, 1.9373817464976615, 1.9346524862117531, 1.9220982966014493, 1.8654971871020676, 1.7912613596530638, 1.7388844821240803, 1.7272702914713678, 1.718685566571717, 1.6743234170238632, 1.6654094164646613, 1.6452701174518154, 1.6255659323838043, 1.6021812211175992, 1.553148690902549, 1.5330606958101705, 1.5287305137360538, 1.4689581275600438, 1.426458900929335, 1.378167807855521, 1.3730441478694004, 1.2621560920142958, 1.2437864463663875, 1.2410144214604186, 1.1930917833709405, 1.1915380358921308, 1.1858992051335258, 1.178162083793447, 1.157149661642321, 1.1531979369221688, 1.1369280977556713, 1.1242063907341986, 1.1213396646568452, 1.0963017608599002, 1.0909269234235794, 1.0740982936703116, 1.0495945809116933, 1.0465691441666936, 1.0455765876545597, 1.0386766436104484, 1.0362168442051782, 1.0342273322099376, 1.0150499669102775, 0.9994408534873136, 0.9975767075303633, 0.9740277687047397, 0.9631976558480253, 0.9521201371826666, 0.9516034338512245, 0.9405008207637828, 0.9193309738361278, 0.9109491878973853, 0.9029442605246754, 0.9000713386685091, 0.8925885628916461, 0.8903337528534433, 0.8778339585134921, 0.8644440257055129, 0.8430990593456736, 0.824593741951938, 0.8219145925092874, 0.8075098987473602, 0.79565596267674, 0.781178993225549, 0.7685525737237847, 0.7661495505266973, 0.7577983268887681, 0.7294759383098467, 0.728818201791508, 0.7188289843215406, 0.717619195479582, 0.7119425923795196, 0.6983197046075552, 0.697253949433652, 0.696504931608908, 0.6919789065596809, 0.6901087233742963, 0.6881201109322257, 0.6876337952120088, 0.6862047348679269, 0.6857880262571988, 0.6851216969553287, 0.6721889554175478, 0.6715397852794269, 0.6715191940666086]
# test_mae = [6.3478260869565215, 6.331243598326234, 6.322742474916388, 6.30783099975436, 5.973063129452223, 5.703620741057165, 5.581449571377823, 5.573734449069121, 5.561440758235105, 5.552425811212721, 5.521133045752884, 5.458661074841571, 5.442193669196101, 5.344738483305534, 5.339920030955157, 5.323919173689991, 5.291840011295358, 5.2794716226165495, 5.275759510109327, 5.260478731855429, 5.192769360054037, 5.100803918386112, 5.041105814113092, 5.028629307427994, 5.017950861967465, 4.962677435074051, 4.949143333265654, 4.919135581486084, 4.890965831825519, 4.857677497865195, 4.78829887705477, 4.759043883756273, 4.7529217752036645, 4.666558439550877, 4.5988429221610065, 4.519843776814616, 4.511360496668756, 4.333274906822003, 4.305747004284863, 4.301461020196728, 4.227926447834828, 4.225276543311936, 4.216034647378722, 4.202771563232613, 4.165669790108398, 4.161013762651684, 4.137966491943942, 4.122629879208892, 4.11916107045006, 4.089239968879367, 4.083453507944409, 4.0621465618961095, 4.03575824485876, 4.033416999853118, 4.032763870525408, 4.0291477516452785, 4.027907243845748, 4.026881425702973, 4.01729724813336, 4.010437880834004, 4.009903316636233, 4.00343760274928, 4.000683852087738, 3.998390476378639, 3.9983505093817864, 3.9982463850769965, 3.9972391430359044, 3.9971125272444445, 3.997364192200956, 3.9973346776244085, 3.9968701127547512, 3.996775319115551, 3.991819268176437, 3.9881014609412553, 3.98300699285119, 3.979886420961528, 3.9794444140130594, 3.9795193743858848, 3.979414681774469, 3.9808219825192284, 3.982002868290623, 3.9820722999450826, 3.983141109144774, 3.9840099746185738, 3.984089363351669, 3.991959390267796, 3.99314045762539, 3.9981425971586786, 4.015812585575986, 4.017366098275903, 4.0185248180903415, 4.026229789570236, 4.030912949754378, 4.035016446435941, 4.036147572452714, 4.0393064857973044, 4.040505935467049, 4.042427009485666, 4.08489026288686, 4.089401349544616, 4.08957224694594]
# train_mae_hist = [2.2774479338842974, 2.2043628488152615, 2.125395041322314, 1.9411573434232798, 1.845821438923739, 1.755725650812617, 1.7126834478409505, 1.6790104255405462, 1.64469817021376, 1.6057781871559973, 1.5558348262963086, 1.523521440940672, 1.4690175110340382, 1.389769480451107, 1.3663362414194664, 1.3301699290072835, 1.3191615581864653, 1.300991745573217, 1.2663337593949064, 1.257402988786117, 1.2433999620601257, 1.2338473527207414, 1.2165084267199084, 1.1656583404668812, 1.1382204477480116, 1.1345021348299384, 1.120507691160367, 1.0912446458315281, 1.065115733605657, 1.0443215229372875, 1.0216313263382193, 0.989816899757332, 0.9775022924015604, 0.9582658599068848, 0.9505986630354755, 0.9435297658853518, 0.9275871334456631, 0.8882349579423376, 0.8681665788278397, 0.8616402122510731, 0.8306018601826083, 0.8121066638794953, 0.7913310597834627, 0.7754989448112622, 0.7639945375970392, 0.7556734002603945, 0.7421785942307041, 0.7335977919838582, 0.7131389730016655, 0.6875501079658255, 0.6690469736816573, 0.650962107775007, 0.6365142016946382, 0.631227003210107, 0.6147963663556849, 0.6145467601790346, 0.5901240588248658, 0.582551723542115, 0.578664210457459, 0.5600665205797833, 0.5442294623310837, 0.5275706486286095, 0.5065621974120261, 0.49836254307743566, 0.4869468167476721, 0.48138351444723865, 0.4706286584237984, 0.4649770431194958, 0.46315683207421166, 0.46336291774003485, 0.4492927981673391, 0.44376838158050536, 0.43682608224665914, 0.4248235635382863, 0.41311354491600377, 0.4131957055968188, 0.4054835752319032, 0.38514108120389845, 0.3805968016616797, 0.37306033313106013, 0.36582212865563507, 0.3596367713159005, 0.3523047762982008, 0.342554266932905, 0.3359999336241731, 0.33038089261212933, 0.3244989923828411, 0.3197473010027587, 0.3132693870201291, 0.3100660040238339, 0.3037630733892047, 0.29376222965586585, 0.29215901853441884, 0.2857268639444816, 0.2835275816399381, 0.2764835823019258, 0.2754770503536573, 0.27153329516156344, 0.26450371243827897, 0.26056311545490507, 0.25784684185150447]
# test_mae_hist = [3.6605533596837945, 3.6434821654132798, 3.623399209486166, 3.8801847707033663, 3.8553216467098084, 3.914924961153353, 3.981357507323982, 3.9722929486942067, 3.934242882818053, 4.092667992790739, 4.078387799641123, 4.045312424171803, 4.120860330823207, 4.120860330823207, 4.01101800124933, 4.069022371827823, 4.069022371827823, 4.105699268068227, 4.127982087503182, 4.103125087475451, 4.205871060248233, 4.222948374927685, 4.222948374927685, 4.1161136472436946, 4.157847097976059, 4.157847097976059, 4.157847097976058, 4.198596450559312, 4.0701548075990175, 4.181953971657565, 4.220835858449352, 4.1922253820848105, 4.110425453996956, 4.147348219622147, 4.124315952078837, 4.124315952078837, 4.104101858947803, 4.17702559842271, 4.17702559842271, 4.163378412294868, 4.185529154335615, 4.16472431576302, 4.225650231442503, 4.119177512973043, 4.119177512973043, 4.1065689384044655, 4.1761312397373835, 4.096809709783929, 4.096809709783929, 4.062791745269712, 4.120887358328797, 4.025046597561056, 4.06619750942415, 4.02994367463111, 4.042806662447487, 4.00463746321725, 4.063390377235417, 4.031073584058974, 4.008841786141739, 4.057187493606874, 4.067335280655957, 4.04515220237078, 4.07989760130757, 4.063392064215712, 4.086405690595887, 4.060996084918232, 4.069818091935038, 4.069818091935038, 4.065585259975683, 4.071563603892866, 4.081923664145545, 4.066545931963923, 4.081238951698996, 4.081238951698996, 4.123600395442051, 4.123600395442051, 4.1092756184129975, 4.1092756184129975, 4.102355783259231, 4.102355783259231, 4.102355783259231, 4.102355783259231, 4.102355783259231, 4.102355783259231, 4.096896194445423, 4.090951933920645, 4.107635869293205, 4.097498537786594, 4.103617713513976, 4.110477600166047, 4.116591536142925, 4.1094028526886754, 4.1094028526886754, 4.12852286185994, 4.147559697784714, 4.124845504674055, 4.11909828821041, 4.14374856971271, 4.122040270284076, 4.135843833759563, 4.125925508845843]




train_mae = np.array(train_mae)
test_mae = np.array(test_mae)
train_mae_hist = np.array(train_mae_hist)
test_mae_hist = np.array(test_mae_hist)

print(train_mae)
print(test_mae)
print(train_mae_hist)
print(test_mae_hist)

plt.figure(figsize=(14, 10))
plt.style.use('ggplot')
plt.plot(list(range(len(train_mae))), train_mae, c='y', label='LARS rules, train dataset')
plt.plot(list(range(len(train_mae))), train_mae_hist, c='b', label='Baseline rules, train dataset')
plt.plot(list(range(len(test_mae))), test_mae, c='y', linestyle='dashed', label='LARS rules, test dataset')
plt.plot(list(range(len(test_mae))), test_mae_hist, c='b', linestyle='dashed', label='Baseline rules, test dataset')
plt.title("Relationship Between Ensemble Size and Mean Squared Error")
plt.legend()
plt.xlabel("Rules")
plt.ylabel("Mean Squared Error")
plt.tight_layout()
plt.savefig(
    os.path.join('Plots',
                 'Pruning',
                 'Embedded',
                 # f'Accuracy_while_pruning_Model_{self.dataset_name}_{self.n_rules}_nu_{self.nu}_sampling_{self.sampling}_use_gradient_{self.use_gradient}.png')

                f'Accuracy_while_pruning_Model_Medical Cost_100_nu_1_sampling_1_use_gradient_True.png')
)
plt.show()